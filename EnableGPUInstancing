using UnityEngine;
using UnityEditor;

public class EnableGPUInstancing : EditorWindow
{
    [MenuItem("Ferramentas/Ativar GPU Instancing nos Selecionados")]
    public static void EnableInstancing()
    {
        int count = 0;
        var selectedObjects = Selection.gameObjects;

        if (selectedObjects.Length == 0)
        {
            Debug.LogWarning("Nenhum objeto selecionado!");
            return;
        }

        foreach (var obj in selectedObjects)
        {
            Renderer renderer = obj.GetComponent<Renderer>();
            if (renderer == null) continue;

            foreach (var mat in renderer.sharedMaterials)
            {
                if (mat == null) continue;

                if (!mat.enableInstancing)
                {
                    Undo.RecordObject(mat, "Ativar GPU Instancing");
                    mat.enableInstancing = true;
                    EditorUtility.SetDirty(mat);
                    count++;
                }
            }
        }

        AssetDatabase.SaveAssets();

        Debug.Log($"âœ… GPU Instancing ativado em {count} materiais!");
    }
}
